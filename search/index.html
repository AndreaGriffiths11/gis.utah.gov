---
layout: page
status: publish
published: true
title: Search Our Data
author:
  display_name: Steve Gourley
date: '2016-03-24 09:07:47 -0700'
date_gmt: '2016-03-24 16:07:47 -0700'
categories: []
tags: []
---
<style>
.search-form {
    display: inline-block;
    width: 100%;
    position: relative;
    padding: 0 2.5rem 0 0
}

.search-form:before {
    position: absolute;
    top: 50%;
    left: 0.5rem;
    z-index: 1;
    font-size: 1rem;
    line-height: 1;
    opacity: 0.32;
    -moz-transform: translate(0, -50%);
    -ms-transform: translate(0, -50%);
    -webkit-transform: translate(0, -50%);
    transform: translate(0, -50%)
}
.search-input:focus {
    outline: 0;
    box-shadow: inset 0 0 0 1px rgba(0,0,0,0.24)
}

.search-input:-moz-placeholder {
    color: rgba(0,0,0,0.48)
}

.search-input::-moz-placeholder {
    color: rgba(0,0,0,0.48)
}

.search-input:-ms-input-placeholder {
    color: rgba(0,0,0,0.48)
}

.search-input::-webkit-input-placeholder {
    color: rgba(0,0,0,0.48)
}
.search-input{
    display: block;
    background: rgba(0,0,0,0.12);
    font-family: "Open Sans","Helvetica Neue",Helvetica,Arial,sans-serif;
    font-weight: normal;
    white-space: nowrap;
    border-radius: 60rem;
    border: 0;
    color: #333;
    box-shadow: inset 0 0 0 1px rgba(0,0,0,0.08);
    width: 100%;
    line-height: 1.5rem;
    font-size: 1rem;
    padding: 0.25rem 0.75rem 0.25rem 2rem;
    min-width: 2rem;
    transform: translateZ(0);
    transition: box-shadow 0.2s ease 0s
}
</style>
<form name="search-form" class="search-form">
      <input type="text" id="search" class="search-input" placeholder="What can we help you find today?" />
</form>
<script>
var data = [{% for post in site.posts %}
  {
    "title": "{{ post.title | escape }}",
    "category": "{{ post.category }}",
    "tags": [{% for tag in post.tags %}"{{ tag }}",{% endfor %}false],
     "href": "{{ post.url | prepend: site.baseurl }}",
     "date": {
      "day": "{{ post.date | date: "%d" }}",
      "month": "{{ post.date | date: "%B" }}",
      "year": "{{ post.date | date: "%Y" }}"
     }
  }, {% endfor %}
  false,{% for post in site.pages %}
  {
     "title": "{{ post.title | escape }}",
     "category": "{{ post.category }}",
     "tags": [{% for tag in post.tags %}"{{ tag }}",{% endfor %}false],
     "href": "{{ post.url | prepend: site.baseurl }}",
     "date": {
      "day": "{{ post.date | date: "%d" }}",
      "month": "{{ post.date | date: "%B" }}",
      "year": "{{ post.date | date: "%Y" }}"
     }
  },{% endfor %},
  false
];

var tokenTree = function (tokenArray) {
    var createLetterObject = function (l) {
        var pChildren = [];

        var getMatchingWords = function (characterArr, availableWords, children) {
            if (characterArr.length === 0) {
                for (var child in children) {
                    if ({}.hasOwnProperty.call(children, child)) {
                        var currentChild = children[child];

                        var words = currentChild.getWords(characterArr);

                        for (var pos in words) {
                            if ({}.hasOwnProperty.call(words, pos)) {
                                availableWords.push(words[pos]);
                            }
                        }

                        if (currentChild.word) {
                            availableWords.push(currentChild.word);
                        }
                    }
                }
            } else {
                var currentCharacter = characterArr.pop();
                getMatchingWords(characterArr, availableWords, children[currentCharacter].children);
            }
        };

        function doGetWords(wordPart) {
            var len = wordPart.length;
            var ar = [];
            var wordList = [];

            for (var ii = len - 1; ii >= 0; ii --) {
                ar.push(wordPart[ii].toUpperCase());
            }

            getMatchingWords(ar, wordList, pChildren);

            return wordList;
        }

        return {
            letter: l,
            children: pChildren,
            parent: null,
            word: null,
            getWords: doGetWords
        };
    };

    var startingPoint = createLetterObject();

    function parseWord(wordCharacterArray, parent, fullWord) {
        if (wordCharacterArray.length === 0) {
            parent.word = fullWord;
            return;
        }

        var currentCharacter = wordCharacterArray.pop().toUpperCase();

        if (!parent.children[currentCharacter]) {
            parent.children[currentCharacter] = createLetterObject(currentCharacter);
        }

        parseWord(wordCharacterArray, parent.children[currentCharacter], fullWord);
    }

    for (var counter in tokenArray) {
        if ({}.hasOwnProperty.call(tokenArray, counter)) {
            var word = tokenArray[counter];

            if (!word) {
                continue;
            }

            var ar = [];

            var wordLength = word.length;

            for (var ii = wordLength - 1; ii >= 0; ii--) {
                ar.push(word[ii]);
            }

            parseWord(ar, startingPoint, word);
        }
    }

    return startingPoint;
};

var tree = tokenTree(data.map(function (item) {
    return item.title;
}));

var queryTree = function(e) {
    var list = tree.getWords(e.target.value);
    console.log(list);
}

var searchNode = document.getElementById('search');

searchNode.addEventListener('change', queryTree);
searchNode.addEventListener('paste', queryTree);
searchNode.addEventListener('input', queryTree);
searchNode.addEventListener('keyup', queryTree);
</script>
